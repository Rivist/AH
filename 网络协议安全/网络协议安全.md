# 网络协议安全

[TOC]



## 1.Arp 协议利用与防护

### 1.1 Arp 协议基础

ARP 地址解析协议 ——用于交换机下二层设备寻址。

ARP 缓存表：将访问主机的MAC和IP绑定。

缓存表缺陷：主机不会验证ARP缓存表，如果有新的出现，就会更新。

### 1.2 ARP欺骗

发送伪造的ARP消息，对特定IP所对应的MAC地址进行假冒欺骗

**两种场景：**

1. 主机欺骗：获取通信流量
2. 网关欺骗：断网/获取所有通信流量

### 1.3 ARP攻击防护

主机欺骗：绑定静态ARP映射——只对主机欺骗有效

网关欺骗：在网关绑定主机MAC地址与IP地址

### 1.4 交换机转发行为

**交换机转发数据原理：**

1. 交换机查看源MAC ，并且将MAC地址与接口进行关联，更新MAC地址表（CAM表）
2. 查看数据包目标MAC地址，然后查询本地地址表，根据MAC对应的接口将数据包转发出去
3. 如果MAC地址表是空或丢弃，广播将这个数据帧进行复制，然后向各个接口转发出去。

**交换机特性：**

- MAC地址表大小有限制，基本在8K
- MAC地址表老化时间默认是300s

### 1.5 MAC地址泛洪攻击原理

**MAC地址泛洪攻击:**

- 攻击者里利用交换机的学习机制，不断发送不同的MAC地址给交换机，充满整个MAC地址表，此时交换机只能进行数据广播，攻击者凭借次获得信息。
- 危害：攻击者通过泛洪攻击对局域网内的流量进行抓取，以达到网络信息收集的目的。

**防御：**

- 每个端口限制主机数量，将超出部分舍弃。



## 2 .TCP协议的利用与防护

### 2.1 TCP协议基础

TCP —— 提供可靠的传输服务，传输前三次握手建立连接。

**三次握手作用**：

- 确保C/S之间能够正常通信，测试链接
- 确保收发数据的同步

### 2.2 SYN Flood 攻击原理

SYN Flood 是一种典型的DoS攻击，是一种利用TCP协议缺陷，发送大量伪造的TCP连接请求，从而使受攻击服务器资源耗尽的攻击方式。

**防护手段：**

1. 监视并释放无效连接

2. 延缓TCB分配方法

   - Syn Cache技术 ：收到SYN之后，先回ACK，在HASH表中保存半连接信息，收到回复报文再建立半连接
   - Syn Cookie技术 ：

3. SYN Proxy防火墙

   对试图穿越的SYN请求进行验证后才放行

4. TCP Safe Reset 技术 ：

   防火墙验证连接之后，发出一个Safe Reset命令包，使Client 重新进行连接，这时，Client重新发送的Syn报文防火墙就直接放行，这种方式不需要对序列号进行修改。

## 3.DHCP协议利用与防护

#### 3.1 DHCP协议基础

DHCP —— 可以自动配置IP地址

- 发送阶段 DHCP Discover
- 提供阶段 DHCP Offer
- 请求阶段 DHCP Request
- 确认阶段 DHCP Ack / DHCP Nak

#### 3.2 DHCP 地址耗尽攻击

不断重复请求DHCP 使ip地址耗尽。

**防护：**Port-Security 技术限制交换机每个端口学习的最大MAC地址数量，来防范DHCP耗尽攻击。







